<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Build Your Company Store</title>
  <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="styles.css?v=7">
  <link rel="stylesheet" href="navigation.css">
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script src="script.js" defer></script>
  <script src="https://cdn.emailjs.com/sdk/2.6.4/email.min.js"></script>
  <script>
    emailjs.init("Ymk4ILqxc716wQA3q");
  </script>
  <style>

    /* Plan Summary Section Styling */
    .container-wide {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 20px;
    }

    .plan-summary-section {
        background: #f8f9fa;
        padding: 60px 0;
        margin-top: 40px;
        border-top: 1px solid #e9ecef;
    }

    .summary-details-grid {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 40px;
        margin-top: 30px;
    }

    .summary-left h3 {
        color: var(--primary-color);
        margin-bottom: 15px;
        font-size: 1.575em; /* Proportionally increased: 1.4 * 1.125 */
    }

    .summary-left ul {
        margin-bottom: 30px;
        padding-left: 20px;
    }

    .summary-left li {
        margin-bottom: 8px;
        color: #333;
    }

    .get-started-faster {
        background: white;
        border: 2px solid var(--primary-color);
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 4px 15px rgba(58, 12, 163, 0.1);
    }

    .get-started-faster h3 {
        color: var(--primary-color);
        margin-bottom: 15px;
        font-size: 1.4625em; /* Proportionally increased: 1.3 * 1.125 */
        text-align: center;
    }

    .get-started-faster p {
        color: #666;
        margin-bottom: 20px;
        text-align: center;
        font-size: 1.069em; /* Proportionally increased: 0.95 * 1.125 */
    }

    .contact-info {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .contact-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        background: #f8f9fa;
        border-radius: 8px;
        transition: all 0.3s ease;
    }

    .contact-item:hover {
        background: var(--primary-color);
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(58, 12, 163, 0.2);
    }

    .contact-item i {
        color: var(--primary-color);
        font-size: 1.2375em; /* Proportionally increased: 1.1 * 1.125 */
        width: 20px;
        text-align: center;
    }

    .contact-item:hover i {
        color: white;
    }

    .contact-item span {
        font-weight: 500;
        font-size: 1.069em; /* Proportionally increased: 0.95 * 1.125 */
    }

    @media (max-width: 768px) {
        .summary-details-grid {
            grid-template-columns: 1fr;
            gap: 25px;
        }
        
        .container-wide {
            padding: 0 15px;
        }
    }

/* form container  */
    section#contact-delivery-section .form-container {
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
    }

    /* Consultation Note Styling - Modern Professional */
    .consultation-note {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(58, 12, 163, 0.15);
        border-radius: 16px;
        margin: 2rem 0;
        padding: 0;
        position: relative;
        overflow: hidden;
        box-shadow: 0 8px 32px rgba(58, 12, 163, 0.08);
        transition: all 0.3s ease;
    }

    .consultation-note:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 40px rgba(58, 12, 163, 0.12);
        border-color: rgba(58, 12, 163, 0.25);
    }

    .consultation-note::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--primary-color), var(--secondary-color), transparent);
    }

    .consultation-note-content {
        padding: 2rem 2.5rem;
        display: flex;
        align-items: flex-start;
        gap: 1.5rem;
    }

    .consultation-icon {
        font-size: 1.5rem;
        color: var(--primary-color);
        flex-shrink: 0;
        background: rgba(58, 12, 163, 0.08);
        padding: 0.75rem;
        border-radius: 12px;
        margin-top: 0.25rem;
    }

    .consultation-note p {
        margin: 0;
        font-size: 1.05rem;
        line-height: 1.6;
        color: #2c3e50;
        font-weight: 400;
        letter-spacing: 0.01em;
    }

    .consultation-note strong {
        color: var(--primary-color);
        font-weight: 600;
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    @media (max-width: 768px) {
        .consultation-note-content {
            padding: 1.75rem 1.5rem;
            gap: 1rem;
        }
        
        .consultation-icon {
            font-size: 1.25rem;
            padding: 0.625rem;
            border-radius: 10px;
        }
        
        .consultation-note p {
            font-size: 0.95rem;
            line-height: 1.5;
        }
    }

    /* Button Styling - Make Save My Plan match Save & Continue */
    #generate-plan-btn {
        background-color: var(--primary-color) !important;
        color: var(--light-color) !important;
        padding: 0.75rem 1.5rem !important;
        border-radius: var(--border-radius) !important;
        text-decoration: none !important;
        transition: all var(--transition-speed) !important;
        margin: 1rem auto 0 !important;
        font-weight: 600 !important;
        border: 2px solid var(--primary-color) !important;
        display: block !important;
        font-size: 1.125rem !important; /* Added proportional base font size */
    }

    #generate-plan-btn:hover {
        background-color: var(--light-color) !important;
        color: var(--secondary-color) !important;
        border-color: var(--secondary-color) !important;
        text-decoration: none !important;
        transform: translateY(-3px) !important;
        box-shadow: 0 6px 12px rgba(0,0,0,0.15) !important;
    }










    /* Inspirational Quote Container */
    .inspirational-quote-container {
      margin: 1.5rem auto;
      max-width: 600px;
      padding: 0 1rem;
    }

    .quote-content {
      background: linear-gradient(135deg, rgba(94, 186, 15, 0.05), rgba(94, 186, 15, 0.1));
      border: 1px solid rgba(94, 186, 15, 0.2);
      border-radius: 12px;
      padding: 1rem 1.5rem;
      text-align: center;
      position: relative;
      box-shadow: 0 2px 10px rgba(94, 186, 15, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      min-height: fit-content;
    }

    .quote-icon {
      color: var(--primary-color);
      font-size: 1.2rem;
      opacity: 0.7;
      flex-shrink: 0;
      align-self: flex-start;
      margin: 0;
    }

    .quote-text {
      font-size: 1.1rem;
      font-weight: 500;
      color: #333;
      margin: 0 !important;
      line-height: 1.2;
      font-style: italic;
      flex: 1;
      padding: 0 !important;
      display: inline;
      vertical-align: middle;
    }

    @media (max-width: 768px) {
      .inspirational-quote-container {
        margin: 1rem auto;
        padding: 0 0.5rem;
      }
      
      .quote-content {
        padding: 0.75rem 1rem;
        gap: 0.3rem;
        min-height: fit-content;
      }
      
      .quote-text {
        font-size: 1rem;
        padding: 0 !important;
        margin: 0 !important;
        line-height: 1.2;
        display: inline;
        vertical-align: middle;
      }
      
      .quote-icon {
        font-size: 1rem;
        margin: 0;
      }
    }

    /* Product Store Section Styling */
    .product-store-section {
      padding: 4rem 2rem;
      max-width: 1400px;
      margin: 0 auto;
      min-height: 100vh;
    }

    .store-header {
      text-align: center;
      margin-bottom: 3rem;
    }

    .store-header h2 {
      color: var(--primary-color);
      margin-bottom: 1rem;
      font-size: 2.5rem;
    }

    .store-description {
      font-size: 1.2rem;
      color: #666;
      max-width: 600px;
      margin: 0 auto;
      line-height: 1.6;
    }

    /* Two Column Layout */
    .store-builder-container {
      display: flex;
      gap: 2rem;
      align-items: flex-start;
      position: relative;
    }

    .product-categories-column {
      flex: 1;
      min-width: 0;
    }

    .store-canvas-column {
      flex: 0 0 400px;
      position: -webkit-sticky;
      position: sticky;
      top: 2rem;
      height: fit-content;
      z-index: 10;
      max-height: calc(100vh - 4rem);
      overflow: visible;
      align-self: flex-start;
    }


    /* Product Categories */
    .product-categories {
      margin-bottom: 3rem;
    }

    .product-category {
      margin-bottom: 1.5rem;
      border: 1px solid #e9ecef;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      transition: all 0.3s ease;
    }

    .product-category:hover {
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    .category-header {
      background: linear-gradient(135deg, var(--primary-color), var(--offset-color));
      color: white;
      padding: 1.5rem 2rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .category-header:hover {
      background: linear-gradient(135deg, var(--offset-color2), var(--offset-color2));
    }

    .category-header h3 {
      color: white;
      margin: 0;
      font-size: 1.4rem;
      display: flex;
      align-items: center;
      justify-content: flex-start;
    }

    .category-header i {
      margin-right: 0.75rem;
      opacity: 0.9;
    }

    .category-toggle {
      font-size: 1.8rem;
      margin-left: auto;
      transition: transform 0.3s ease;
    }

    .category-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease;
      background: #f8f9fa;
    }

    .category-content.expanded {
      max-height: 1000px;
    }

    .category-toggle.rotated {
      transform: rotate(180deg);
    }

    /* Product Grid */
    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 1.25rem;
      padding: 2rem;
    }

    .product-tile {
      background: white;
      border-radius: 8px;
      padding: 1rem;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      border: 2px solid transparent;
      cursor: pointer;
    }

    .product-tile:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      border-color: var(--primary-color);
    }

    .product-tile img {
      width: 100%;
      height: 120px;
      object-fit: cover;
      border-radius: 6px;
      margin-bottom: 1rem;
    }
    
    .product-tile h4 {
      margin: 0;
      font-size: 1.1rem;
      color: var(--primary-color);
      font-weight: 600;
    }

    .product-tile.selected {
      border-color: var(--primary-color);
      background: rgba(58, 12, 163, 0.05);
      position: relative;
    }

    .product-tile.selected::after {
      content: 'âœ“';
      position: absolute;
      top: 8px;
      right: 8px;
      background: var(--primary-color);
      color: white;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: bold;
      z-index: 2;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .product-tile.selected::after:hover {
      background: #c82333;
      transform: scale(1.1);
    }

    .product-tile.dragging {
      opacity: 0.5;
      transform: rotate(5deg);
      z-index: 1000;
    }

    /* Custom Suggestions */
    .custom-suggestions {
      margin: 3rem 0;
      padding: 2rem;
      background: linear-gradient(135deg, rgba(58, 12, 163, 0.05), rgba(58, 12, 163, 0.1));
      border-radius: 12px;
      border: 1px solid rgba(58, 12, 163, 0.1);
    }
    
    .custom-suggestions h3 {
      color: var(--primary-color);
      margin-bottom: 1.5rem;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
    }

    .custom-suggestions h3 i {
      margin-right: 0.75rem;
    }

    .custom-form-container {
      background: white;
      border-radius: 8px;
      padding: 1.5rem;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .custom-form-group {
      margin-bottom: 1rem;
    }
    
    .custom-form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: var(--primary-color);
    }
    
    .custom-form-group textarea {
      width: 100%;
      padding: 1rem;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.3s ease;
      resize: vertical;
      min-height: 100px;
      font-family: inherit;
    }
    
    .custom-form-group textarea:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(58, 12, 163, 0.1);
    }
    
    /* Add to Plan Button */
    .btn-secondary {
      background-color: var(--secondary-color);
      color: white;
      border: 2px solid var(--secondary-color);
      transition: all 0.3s ease;
    }
    
    .btn-secondary:hover:not(:disabled) {
      background-color: #0056b3;
      border-color: #0056b3;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
    }

    .btn-secondary:disabled {
      background-color: #cccccc;
      border-color: #cccccc;
      color: #666666;
      cursor: not-allowed;
      opacity: 0.6;
    }

    /* Custom Ideas List */
    .custom-ideas-list {
      margin-top: 1.5rem;
    }

    .custom-idea-item {
      background: white;
      border: 1px solid #e9ecef;
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 0.75rem;
      position: relative;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      transition: all 0.3s ease;
    }

    .custom-idea-item:hover {
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .custom-idea-text {
      margin: 0;
      color: var(--primary-color);
      font-size: 0.95rem;
      line-height: 1.4;
    }

    .custom-idea-remove {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: #dc3545;
      color: white;
      border: none;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 0.75rem;
      transition: all 0.3s ease;
    }

    .custom-idea-remove:hover {
      background: #c82333;
      transform: scale(1.1);
    }

    /* Captcha Styling */
    .captcha-selector {
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 15px;
    }

    .captcha-selector label {
      color: var(--primary-color);
      font-weight: 600;
      margin-bottom: 8px;
    }

    .captcha-selector select {
      border: 2px solid #e9ecef;
      border-radius: 6px;
      padding: 8px 12px;
      font-size: 14px;
      background: white;
      transition: border-color 0.3s ease;
    }

    .captcha-selector select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(58, 12, 163, 0.1);
    }

    .captcha-selector button {
      background: var(--primary-color);
      color: white;
      border: 2px solid var(--primary-color);
      border-radius: 6px;
      padding: 8px 16px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .captcha-selector button:hover {
      background: var(--secondary-color);
      border-color: var(--secondary-color);
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(58, 12, 163, 0.2);
    }

    .captcha-selector button:active {
      transform: translateY(0);
    }

    /* Store Actions */
    .store-actions {
      text-align: center;
      margin-top: 1.5rem;
      padding-top: 1.5rem;
      border-top: 1px solid rgba(58, 12, 163, 0.1);
    }

    /* Store Actions in Canvas */
    .company-store-canvas .store-actions {
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid rgba(58, 12, 163, 0.15);
    }

    /* Company Store Canvas */
    .company-store-canvas {
      margin: 0;
      background: linear-gradient(135deg, rgba(58, 12, 163, 0.05), rgba(58, 12, 163, 0.08));
      border: 2px solid rgba(58, 12, 163, 0.1);
      border-radius: 12px;
      padding: 1.5rem;
      width: 100%;
      box-sizing: border-box;
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .company-store-canvas h3 {
      color: var(--primary-color);
      margin-bottom: 0.5rem;
      font-size: 1.4rem;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    .company-store-canvas h3 i {
      margin-right: 0.5rem;
      opacity: 0.8;
    }

    .canvas-instructions {
      color: #666;
      margin-bottom: 1.5rem;
      font-size: 0.9rem;
      font-style: italic;
      text-align: center;
      line-height: 1.3;
    }

    .store-canvas {
      min-height: 400px;
      max-height: calc(100vh - 220px);
      background: white;
      border: 2px dashed rgba(58, 12, 163, 0.2);
      border-radius: 8px;
      padding: 1rem;
      position: relative;
      transition: all 0.3s ease;
      overflow-y: auto;
      flex: 1;
    }

    .store-canvas.drag-over {
      background: rgba(58, 12, 163, 0.05);
      border-color: var(--primary-color);
      border-style: solid;
    }

    .canvas-placeholder {
      text-align: center;
      color: #999;
      padding: 3rem;
    }

    .canvas-placeholder i {
      font-size: 3rem;
      margin-bottom: 1rem;
      opacity: 0.5;
    }

    .canvas-placeholder p {
      margin: 0;
      font-size: 0.95rem;
    }

    /* Canvas Store Items */
    .canvas-store-item {
      background: white;
      border: 2px solid var(--primary-color);
      border-radius: 6px;
      padding: 0.6rem;
      margin: 0.3rem 0;
      display: flex;
      align-items: center;
      gap: 0.6rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      transition: all 0.3s ease;
      cursor: move;
      position: relative;
      width: 100%;
      box-sizing: border-box;
    }

    .canvas-store-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    }

    .canvas-store-item img {
      width: 40px;
      height: 40px;
      object-fit: cover;
      border-radius: 4px;
      flex-shrink: 0;
    }

    .canvas-store-item-content {
      flex: 1;
      min-width: 0;
    }

    .canvas-store-item h4 {
      margin: 0;
      color: var(--primary-color);
      font-size: 0.85rem;
      font-weight: 600;
      line-height: 1.2;
      word-wrap: break-word;
    }

    .canvas-store-item-category {
      color: #666;
      font-size: 0.7rem;
      margin: 0.1rem 0 0 0;
      line-height: 1.1;
    }

    .canvas-store-item-remove {
      background: color-mix(in srgb, var(--primary-color), black 30%);
      color: white;
      border: none;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.6rem;
      flex-shrink: 0;
    }

    .canvas-store-item-remove:hover {
      background: color-mix(in srgb, var(--primary-color), transparent 30%);
      transform: scale(1.1);
    }

    /* Custom Idea Items in Store Canvas */
    .custom-idea-item {
      border: 2px solid var(--primary-color) !important; /* Normal brand color border */
      background: linear-gradient(135deg,
        color-mix(in srgb, var(--primary-color), transparent 90%),
        color-mix(in srgb, var(--primary-color), transparent 95%)
      ) !important;
    }

    .custom-idea-item .canvas-store-item-category {
      color: var(--primary-color);
      font-weight: 700; /* Bold for "Custom Product Idea" text */
    }

    .store-actions .btn {
      margin: 0 1rem;
      padding: 1rem 2rem;
      font-size: 1.1rem;
      font-weight: 600;
    }

    /* Canvas Actions Buttons */
    .company-store-canvas .store-actions .btn {
      margin: 0.3rem;
      padding: 0.75rem 1.25rem;
      font-size: 0.95rem;
      font-weight: 600;
      width: calc(50% - 0.6rem);
      display: inline-block;
    }

    /* Responsive Design */
    @media (max-width: 1200px) {
      .store-builder-container {
        gap: 1.5rem;
      }

      .store-canvas-column {
        flex: 0 0 350px;
      }
    }

    @media (max-width: 1024px) {
      .store-builder-container {
        flex-direction: column;
        gap: 2rem;
      }

      .store-canvas-column {
        position: static;
        flex: none;
        order: -1;
        width: 100%;
        max-width: none;
      }

      .company-store-canvas {
        margin-bottom: 2rem;
        width: 100%;
        max-width: none;
      }
    }

    @media (max-width: 768px) {
      .product-store-section {
        padding: 2rem 1rem;
      }

      .store-header h2 {
        font-size: 2rem;
      }

      .store-builder-container {
        gap: 1.5rem;
      }

      .product-categories-column,
      .store-canvas-column {
        width: 100%;
      }

      .category-header {
        padding: 1rem 1.5rem;
      }

      .category-header h3 {
        font-size: 1.2rem;
      }

      .product-grid {
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        padding: 1.5rem;
        gap: 1rem;
      }

      .product-tile {
        padding: 0.75rem;
      }

      .product-tile img {
        height: 90px;
      }

      .custom-suggestions {
        padding: 1rem;
      }

      .store-actions {
        margin-top: 2rem;
        padding-top: 1.5rem;
      }

      .store-actions .btn {
        margin: 0.5rem;
        display: block;
        width: 100%;
        max-width: 300px;
        margin: 0.5rem auto;
      }

      .company-store-canvas .store-actions .btn {
        width: 100%;
        margin: 0.3rem 0;
      }

      /* Custom Ideas Responsive */
      .custom-form-group textarea {
        font-size: 0.9rem;
      }

      .btn-secondary {
        width: 100%;
        margin-top: 0.5rem;
        font-size: 0.9rem;
      }

      .custom-idea-item {
        padding: 0.75rem;
      }

      .custom-idea-text {
        font-size: 0.9rem;
      }

      .company-store-canvas {
        margin: 2rem 0;
      }

      .store-canvas {
        min-height: 250px;
        padding: 1.5rem;
      }

      .canvas-placeholder p {
        font-size: 0.9rem;
      }
    }

    @media (max-width: 480px) {
      .product-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.75rem;
        padding: 1rem;
      }

      .product-tile {
        padding: 0.75rem;
      }

      .product-tile img {
        height: 80px;
      }

      .product-tile h4 {
        font-size: 0.9rem;
      }

      .store-builder-container {
        gap: 1rem;
      }

      .product-categories-column,
      .store-canvas-column {
      width: 100%;
      }
    }

    /* Canvas Item Responsive */
    @media (max-width: 768px) {
      .canvas-store-item {
        flex-direction: column;
        text-align: center;
      padding: 0.75rem;
        margin: 0.5rem;
      }

      .canvas-store-item img {
        width: 50px;
        height: 50px;
        margin-bottom: 0.5rem;
      }

      .canvas-store-item-content {
        margin-bottom: 0.5rem;
      }

      .canvas-store-item-remove {
        position: absolute;
        top: 5px;
        right: 5px;
        width: 25px;
        height: 25px;
        font-size: 0.7rem;
      }
    }

  </style>
  <!-- Load centralized navigation BEFORE your main script -->
  <script src="navigation.js"></script>
</head>
<body>
  <!-- Navigation will be inserted here automatically by navigation.js -->

  <!-- Main content wrapper -->
  <main>

    <!-- MOVED: Hero Section -->
    <section class="hero">
      <div class="container">
        <h1></h1>
        <!-- Removed p and button -->
      </div>
    </section>

    <!-- Product Store Section -->
    <section class="product-store-section">
      <div class="store-header">
        <h2>Build Your Company Store</h2>
        <p class="store-description">Explore our curated collection of recognition products. These are just some ideas to start your plan!</p>
      </div>

        <form id="plan-details-form" class="plan-details-form-1"> 
          <input name="affiliateName" type="hidden" value="Rick Badiner">
          <input name="affiliateEmail" type="hidden" value="Rbadiner@rbbmarketing.com">
          <input name="headerImgPath" type="hidden" value="https://htmlgen.webdevbydesign.com/img/rbb-header.png">
          <input name="footerImgPath" type="hidden" value="https://htmlgen.webdevbydesign.com/img/rbb-footer.png">

        <div class="store-builder-container">
          <!-- Left Column: Product Categories -->
          <div class="product-categories-column">
            <div class="product-categories">
          <!-- Apparel Category -->
          <div class="product-category">
            <div class="category-header" onclick="toggleCategory('apparel')">
              <h3><i class="fas fa-tshirt"></i> Apparel <i class="fas fa-chevron-down category-toggle"></i></h3>
              </div>
            <div id="apparel-content" class="category-content">
              <div class="product-grid">
                <div class="product-tile" draggable="true" data-product="Zip Jacket" data-category="Apparel" data-image="assets/images/Apparel.png">
                  <img src="assets/images/Apparel.png" alt="Zip Jacket">
                  <h4>Zip Jacket</h4>
                  <input type="checkbox" name="planList" value="Zip Jacket" class="hidden">
            </div>
                <div class="product-tile" draggable="true" data-product="T-Shirt" data-category="Apparel" data-image="assets/images/Apparel2.png">
                  <img src="assets/images/Apparel2.png" alt="T-Shirt">
                  <h4>T-Shirt</h4>
                  <input type="checkbox" name="planList" value="T-Shirt" class="hidden">
              </div>
                <div class="product-tile" draggable="true" data-product="Pullover" data-category="Apparel" data-image="assets/images/ApparelSweater.png">
                  <img src="assets/images/ApparelSweater.png" alt="Pullover">
                  <h4>Pullover</h4>
                  <input type="checkbox" name="planList" value="Pullover" class="hidden">
            </div>
                <div class="product-tile" draggable="true" data-product="Triblend T-Shirt" data-category="Apparel" data-image="assets/images/triblend-tshirts.jpg">
                  <img src="assets/images/triblend-tshirts.jpg" alt="Triblend T-Shirt">
                  <h4>Triblend T-Shirt</h4>
                  <input type="checkbox" name="planList" value="Triblend T-Shirt" class="hidden">
              </div>
            </div>
              </div>
            </div>

          <!-- Bags & Totes Category -->
          <div class="product-category">
            <div class="category-header" onclick="toggleCategory('bags')">
              <h3><i class="fas fa-shopping-bag"></i> Bags & Totes <i class="fas fa-chevron-down category-toggle"></i></h3>
              </div>
            <div id="bags-content" class="category-content">
              <div class="product-grid">
                <div class="product-tile" draggable="true" data-product="Laptop Bag" data-category="Bags & Totes" data-image="assets/images/backpack1.jpg">
                  <img src="assets/images/backpack1.jpg" alt="Laptop Bag">
                  <h4>Laptop Bag</h4>
                  <input type="checkbox" name="planList" value="Laptop Bag" class="hidden">
            </div>
                <div class="product-tile" draggable="true" data-product="Backpack" data-category="Bags & Totes" data-image="assets/images/SlingBackpacks.png">
                  <img src="assets/images/SlingBackpacks.png" alt="Backpack">
                  <h4>Backpack</h4>
                  <input type="checkbox" name="planList" value="Backpack" class="hidden">
              </div>
                <div class="product-tile" draggable="true" data-product="Tote" data-category="Bags & Totes" data-image="assets/images/tote1.jpg">
                  <img src="assets/images/tote1.jpg" alt="Tote">
                  <h4>Tote</h4>
                  <input type="checkbox" name="planList" value="Tote" class="hidden">
            </div>
                <div class="product-tile" draggable="true" data-product="Travel Bag" data-category="Bags & Totes" data-image="assets/images/travelbag1.jpg">
                  <img src="assets/images/travelbag1.jpg" alt="Travel Bag">
                  <h4>Travel Bag</h4>
                  <input type="checkbox" name="planList" value="Travel Bag" class="hidden">
              </div>
            </div>
              </div>
            </div>

          <!-- Drinkware Category -->
          <div class="product-category">
            <div class="category-header" onclick="toggleCategory('drinkware')">
              <h3><i class="fas fa-coffee"></i> Drinkware <i class="fas fa-chevron-down category-toggle"></i></h3>
              </div>
            <div id="drinkware-content" class="category-content">
              <div class="product-grid">
                <div class="product-tile" draggable="true" data-product="Water Bottle" data-category="Drinkware" data-image="assets/images/waterbottle1.png">
                  <img src="assets/images/waterbottle1.png" alt="Water Bottle">
                  <h4>Water Bottle</h4>
                  <input type="checkbox" name="planList" value="Water Bottle" class="hidden">
            </div>
                <div class="product-tile" draggable="true" data-product="Tumbler" data-category="Drinkware" data-image="assets/images/Arctic-Zone-Titan-24-oz.-Copper-Mug-1024x1024.jpg">
                  <img src="assets/images/Arctic-Zone-Titan-24-oz.-Copper-Mug-1024x1024.jpg" alt="Tumbler">
                  <h4>Tumbler</h4>
                  <input type="checkbox" name="planList" value="Tumbler" class="hidden">
              </div>
                <div class="product-tile" draggable="true" data-product="Mug" data-category="Drinkware" data-image="assets/images/Ceramic Mugs.jpg">
                  <img src="assets/images/Ceramic Mugs.jpg" alt="Mug">
                  <h4>Mug</h4>
                  <input type="checkbox" name="planList" value="Mug" class="hidden">
            </div>
                <div class="product-tile" draggable="true" data-product="Insulated Tall Mug" data-category="Drinkware" data-image="assets/images/copper-mug.jpg">
                  <img src="assets/images/copper-mug.jpg" alt="Insulated Tall Mug">
                  <h4>Insulated Tall Mug</h4>
                  <input type="checkbox" name="planList" value="Insulated Tall Mug" class="hidden">
              </div>
            </div>
              </div>
            </div>

          <!-- Office Category -->
          <div class="product-category">
            <div class="category-header" onclick="toggleCategory('office')">
              <h3><i class="fas fa-briefcase"></i> Office <i class="fas fa-chevron-down category-toggle"></i></h3>
              </div>
            <div id="office-content" class="category-content">
              <div class="product-grid">
                <div class="product-tile" draggable="true" data-product="Note Cards" data-category="Office" data-image="assets/images/ThankyouNotes.png">
                  <img src="assets/images/ThankyouNotes.png" alt="Note Cards">
                  <h4>Note Cards</h4>
                  <input type="checkbox" name="planList" value="Note Cards" class="hidden">
            </div>
                <div class="product-tile" draggable="true" data-product="Pens" data-category="Office" data-image="assets/images/Pens.png">
                  <img src="assets/images/Pens.png" alt="Pens">
                  <h4>Pens</h4>
                  <input type="checkbox" name="planList" value="Pens" class="hidden">
              </div>
                <div class="product-tile" draggable="true" data-product="Sticky Notes" data-category="Office" data-image="assets/images/StickyNotes.png">
                  <img src="assets/images/StickyNotes.png" alt="Sticky Notes">
                  <h4>Sticky Notes</h4>
                  <input type="checkbox" name="planList" value="Sticky Notes" class="hidden">
                </div>
                <div class="product-tile" draggable="true" data-product="Notebooks" data-category="Office" data-image="assets/images/Pamplets1.PNG">
                  <img src="assets/images/Pamplets1.PNG" alt="Notebooks">
                  <h4>Notebooks</h4>
                  <input type="checkbox" name="planList" value="Notebooks" class="hidden">
                </div>
            </div>
          </div>
        </div>

          <!-- Outdoor Category -->
          <div class="product-category">
            <div class="category-header" onclick="toggleCategory('outdoor')">
              <h3><i class="fas fa-campground"></i> Outdoor <i class="fas fa-chevron-down category-toggle"></i></h3>
          </div>
            <div id="outdoor-content" class="category-content">
              <div class="product-grid">
                <div class="product-tile" draggable="true" data-product="Drink Cooler" data-category="Outdoor" data-image="assets/images/LunchCooler.png">
                  <img src="assets/images/LunchCooler.png" alt="Drink Cooler">
                  <h4>Drink Cooler</h4>
                  <input type="checkbox" name="planList" value="Drink Cooler" class="hidden">
                </div>
                <div class="product-tile" draggable="true" data-product="Hiking Backpack" data-category="Outdoor" data-image="assets/images/backpack-tote-combination.jpg">
                  <img src="assets/images/backpack-tote-combination.jpg" alt="Hiking Backpack">
                  <h4>Hiking Backpack</h4>
                  <input type="checkbox" name="planList" value="Hiking Backpack" class="hidden">
                </div>
                <div class="product-tile" draggable="true" data-product="Outdoor Speaker" data-category="Outdoor" data-image="assets/images/UsefulTech.png">
                  <img src="assets/images/UsefulTech.png" alt="Outdoor Speaker">
                  <h4>Outdoor Speaker</h4>
                  <input type="checkbox" name="planList" value="Outdoor Speaker" class="hidden">
                </div>
                <div class="product-tile" draggable="true" data-product="Adventure Sling" data-category="Outdoor" data-image="assets/images/SlingBag2.png">
                  <img src="assets/images/SlingBag2.png" alt="Adventure Sling">
                  <h4>Adventure Sling</h4>
                  <input type="checkbox" name="planList" value="Adventure Sling" class="hidden">
                </div>
              </div>
        </div>
      </div>

          <!-- Tech Items Category -->
          <div class="product-category">
            <div class="category-header" onclick="toggleCategory('tech')">
              <h3><i class="fas fa-mobile-alt"></i> Tech Items <i class="fas fa-chevron-down category-toggle"></i></h3>
        </div>
            <div id="tech-content" class="category-content">
              <div class="product-grid">
                <div class="product-tile" draggable="true" data-product="Charger" data-category="Tech Items" data-image="assets/images/TechItems.png">
                  <img src="assets/images/TechItems.png" alt="Charger">
                  <h4>Charger</h4>
                  <input type="checkbox" name="planList" value="Charger" class="hidden">
                </div>
                <div class="product-tile" draggable="true" data-product="Speakers" data-category="Tech Items" data-image="assets/images/TechItems2.png.png">
                  <img src="assets/images/TechItems2.png.png" alt="Speakers">
                  <h4>Speakers</h4>
                  <input type="checkbox" name="planList" value="Speakers" class="hidden">
                </div>
                <div class="product-tile" draggable="true" data-product="Headsets" data-category="Tech Items" data-image="assets/images/TechItems3.png">
                  <img src="assets/images/TechItems3.png" alt="Headsets">
                  <h4>Headsets</h4>
                  <input type="checkbox" name="planList" value="Headsets" class="hidden">
                </div>
                <div class="product-tile" draggable="true" data-product="Tech Accessories" data-category="Tech Items" data-image="assets/images/UsefulTech.png">
                  <img src="assets/images/UsefulTech.png" alt="Tech Accessories">
                  <h4>Tech Accessories</h4>
                  <input type="checkbox" name="planList" value="Tech Accessories" class="hidden">
                </div>
              </div>
            </div>
      </div>

          <!-- Simple Amenities Category -->
          <div class="product-category">
            <div class="category-header" onclick="toggleCategory('amenities')">
              <h3><i class="fas fa-gift"></i> Simple Amenities <i class="fas fa-chevron-down category-toggle"></i></h3>
            </div>
            <div id="amenities-content" class="category-content">
              <div class="product-grid">
                <div class="product-tile" draggable="true" data-product="Custom Socks" data-category="Simple Amenities" data-image="assets/images/CustomSocks.png.png">
                  <img src="assets/images/CustomSocks.png.png" alt="Custom Socks">
                  <h4>Custom Socks</h4>
                  <input type="checkbox" name="planList" value="Custom Socks" class="hidden">
                </div>
                <div class="product-tile" draggable="true" data-product="Gift Cards" data-category="Simple Amenities" data-image="assets/images/GiftCards.png">
                  <img src="assets/images/GiftCards.png" alt="Gift Cards">
                  <h4>Gift Cards</h4>
                  <input type="checkbox" name="planList" value="Gift Cards" class="hidden">
                </div>
                <div class="product-tile" draggable="true" data-product="Customized Tokens" data-category="Simple Amenities" data-image="assets/images/CustomizedTokens.png">
                  <img src="assets/images/CustomizedTokens.png" alt="Customized Tokens">
                  <h4>Customized Tokens</h4>
                  <input type="checkbox" name="planList" value="Customized Tokens" class="hidden">
                </div>
                <div class="product-tile" draggable="true" data-product="Reward Points" data-category="Simple Amenities" data-image="assets/images/Points.jpg">
                  <img src="assets/images/Points.jpg" alt="Reward Points">
                  <h4>Reward Points</h4>
                  <input type="checkbox" name="planList" value="Reward Points" class="hidden">
                </div>
              </div>
            </div>
      </div>
      
          <!-- Awards Category -->
          <div class="product-category">
            <div class="category-header" onclick="toggleCategory('awards')">
              <h3><i class="fas fa-award"></i> Awards <i class="fas fa-chevron-down category-toggle"></i></h3>
            </div>
            <div id="awards-content" class="category-content">
              <div class="product-grid">
                <div class="product-tile" draggable="true" data-product="Glass Awards" data-category="Awards" data-image="assets/images/GlassAward.PNG">
                  <img src="assets/images/GlassAward.PNG" alt="Glass Awards">
                  <h4>Glass Awards</h4>
                  <input type="checkbox" name="planList" value="Glass Awards" class="hidden">
                </div>
                <div class="product-tile" draggable="true" data-product="Plaques" data-category="Awards" data-image="assets/images/PlaquesWithStands.png">
                  <img src="assets/images/PlaquesWithStands.png" alt="Plaques">
                  <h4>Plaques</h4>
                  <input type="checkbox" name="planList" value="Plaques" class="hidden">
                </div>
                <div class="product-tile" draggable="true" data-product="Employee of the Month" data-category="Awards" data-image="assets/images/EmployeeOfTheMonth.PNG">
                  <img src="assets/images/EmployeeOfTheMonth.PNG" alt="Employee of the Month">
                  <h4>Employee of the Month</h4>
                  <input type="checkbox" name="planList" value="Employee of the Month" class="hidden">
                </div>
                <div class="product-tile" draggable="true" data-product="Wall Award" data-category="Awards" data-image="assets/images/WallAward.PNG">
                  <img src="assets/images/WallAward.PNG" alt="Wall Award">
                  <h4>Wall Award</h4>
                  <input type="checkbox" name="planList" value="Wall Award" class="hidden">
                </div>
              </div>
            </div>
          </div>
            </div>

            <!-- Custom Suggestions Section -->
            <div class="custom-suggestions">
              <h3><i class="fas fa-lightbulb"></i> Custom Product Ideas</h3>
              <div class="custom-form-container">
                <div class="custom-form-group">
                  <label for="custom-product-input">Describe your custom product idea:</label>
                  <textarea id="custom-product-input" rows="3" placeholder="Tell us about your custom product idea..."></textarea>
                </div>
                <button id="add-custom-idea-btn" class="btn btn-secondary" disabled>Add to Plan</button>

                <div id="custom-ideas-list" class="custom-ideas-list">
                  <!-- Custom ideas will be added here -->
                </div>
              </div>
            </div>

          </div>

        <!-- Right Column: My Company Store Canvas -->
        <div class="store-canvas-column">
          <div class="company-store-canvas">
            <h3><i class="fas fa-store"></i> My Company Store</h3>
            <p class="canvas-instructions">Drag products from the left into your store, or simply click to add them.</p>
            <div id="store-canvas" class="store-canvas">
              <div class="canvas-placeholder">
                <i class="fas fa-shopping-cart"></i>
                <p>Your store is empty. Drag products here or click on them to add to your store!</p>
              </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="store-actions">
              <button id="save-program-btn" class="btn" onclick="saveCompanyStorePlan()">Save My Company Store</button>
              <button id="start-over-btn" class="btn btn-outline" onclick="clearStore()">Start Over</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Contact & Delivery Details Section -->
    <section id="contact-delivery-section" class="contact-delivery-section" style="display: none;">
      <div class="form-container">
                        <h2 style="color: black;">Submit and Save Your Plan.</h2>
          <div class="form-grid">
              <div class="form-group">
                <label for="first-name">First Name*</label>
                <input type="text" id="first-name" name="firstName" required>
              </div>
              <div class="form-group">
                <label for="last-name">Last Name*</label>
                <input type="text" id="last-name" name="lastName" required>
              </div>
              <div class="form-group">
                <label for="company-name">Company Name*</label>
                <input type="text" id="company-name" name="companyName" required>
              </div>
              <div class="form-group">
                <label for="email">Email*</label>
                <input type="email" id="email" name="email" required>
              </div>
              <div class="form-group">
                <label for="phone">Phone</label>
                <input type="tel" id="phone" name="phone">
                <small>Optional: Only if you'd like a quick call.</small>
              </div>
               <!-- Simple Math Captcha -->
              <div class="form-group">
                  <label for="captcha">Security Check* <span id="captcha-question"></span> = ?</label>
                  <input type="number" id="captcha" name="captcha" required onwheel="return false;" onkeydown="if(event.key==='ArrowUp'||event.key==='ArrowDown') return false;">
                  <input type="hidden" id="captcha-num1">
                  <input type="hidden" id="captcha-num2">
              </div>
          </div>
          
          <!-- Selected Features Display -->
          <div id="form-selected-features" class="form-selected-features">
            <h3>Your Customized Selection</h3>
            <div id="form-features-list" class="form-features-list">
              <!-- Features will be populated by JavaScript -->
            </div>

          </div>
          
          <!-- Consultation Note -->
          <div class="consultation-note">
            <div class="consultation-note-content">
              <i class="fas fa-handshake consultation-icon"></i>
              <p>Submit your plan today to receive a <strong>no-charge consultation</strong> with us. We can share ideas that fit your goals and budget -- at no cost to you!</p>
            </div>
          </div>
          
          <button type="submit" id="generate-plan-btn" class="btn">Save My Plan</button>
        </form>
      </div>
    </section>

    <!-- Printable Plan Summary (Initially Hidden) -->
    <section id="plan-summary-section" class="plan-summary-section" style="display: none;">
        <div class="container-wide">
            <div id="plan-summary-content" class="plan-summary-content">
                <!-- Content generated by JS -->
                <div class="summary-header">
                    <img src="assets/images/Logo.png" alt="RBB Marketing Logo" class="summary-logo">
                    <h2>Your Customized Selection</h2>
                </div>
                <div id="whats-next" class="whats-next">
                     <h3>What's Next:</h3>
                     <ul>
                         <li>We've emailed your summary</li>
                         <li>Expect tips over the next week</li>
                         <li>We'll reach out shortly to talk about your personalized plan!</li>
                     </ul>
                </div>
                
                <div class="summary-details-grid">
                    <div class="summary-left">
                        <h3>Your Customized Selection:</h3>
                        <ul id="summary-modules-list"></ul>
                        <h3>Your Details:</h3>
                        <p id="summary-contact-info"></p>
                    </div>
                    
                    <div class="summary-right">
                        <div class="get-started-faster">
                            <h3>Get Started Faster</h3>
                            <p>Have questions or ready to move forward? Contact us directly:</p>
                            <div class="contact-info">
                                <div class="contact-item">
                                    <i class="fas fa-phone"></i>
                                    <span>(847) 877-2240</span>
                                </div>
                                <div class="contact-item">
                                    <i class="fas fa-envelope"></i>
                                    <span>Rbadiner@rbbmarketing.com</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <button onclick="window.print()" class="btn btn-outline print-button">Print Summary</button>
        </div>
    </section>

    <!-- MOVED: Existing content moved below the new sections -->
    <!-- The following container and its content will be removed -->
    <!-- 
    <div class="container"> 
        <section class="featured-products-section">
          [...]
        </section>

        <section class="why-choose-us">
          [...]
        </section>
    </div> 
    -->

  </main> <!-- Close main content wrapper -->



    <!-- Functionality now handled by script.js -->
<script>
// Category toggle function - keep only this for onclick handlers
function toggleCategory(category) {
  const content = document.getElementById(category + '-content');
  const toggle = content.previousElementSibling.querySelector('.category-toggle');

  if (content.classList.contains('expanded')) {
    content.classList.remove('expanded');
    toggle.classList.remove('rotated');
  } else {
    content.classList.add('expanded');
    toggle.classList.add('rotated');

    // Reinitialize drag and drop for newly visible product tiles
    if (window.reinitializeCompanyStoreDragAndDrop) {
      window.reinitializeCompanyStoreDragAndDrop();
    }
  }
}

// Drag and Drop Functionality
let draggedProduct = null;

function handleDragStart(e) {
  // Ensure we're getting the product tile element, not a child
  const productTile = e.target.closest('.product-tile');
  if (!productTile) return;

  draggedProduct = {
    product: productTile.dataset.product,
    category: productTile.dataset.category,
    image: productTile.dataset.image
  };

  // Add dragging class to the tile
  productTile.classList.add('dragging');
  e.dataTransfer.effectAllowed = 'copy';
  e.dataTransfer.setData('text/html', productTile.outerHTML);
}

function handleDragEnd(e) {
  // Ensure we're getting the product tile element, not a child
  const productTile = e.target.closest('.product-tile');
  if (productTile) {
    productTile.classList.remove('dragging');
  }
  draggedProduct = null;
}

function handleDragOver(e) {
  e.preventDefault();
  e.dataTransfer.dropEffect = 'copy';
  const canvas = e.currentTarget;
  canvas.classList.add('drag-over');
}

function handleDragLeave(e) {
  const canvas = e.currentTarget;
  canvas.classList.remove('drag-over');
}

function handleDrop(e) {
  e.preventDefault();
  const canvas = e.currentTarget;
  canvas.classList.remove('drag-over');

  if (draggedProduct && draggedProduct.product) {
    addProductToStore(draggedProduct);
  } else {
    // Fallback: try to get product data from dragged HTML
    const draggedHTML = e.dataTransfer.getData('text/html');
    if (draggedHTML) {
      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = draggedHTML;
      const draggedTile = tempDiv.querySelector('.product-tile');

      if (draggedTile) {
        const productData = {
          product: draggedTile.dataset.product,
          category: draggedTile.dataset.category,
          image: draggedTile.dataset.image
        };

        if (productData.product) {
          addProductToStore(productData);
        }
      }
    }
  }
}

function addProductToStore(productData) {
  // Ensure we have valid product data
  if (!productData || !productData.product || !productData.category) {
    console.error('Invalid product data:', productData);
    return;
  }

  // Find the original tile and mark it as selected
  const originalTile = document.querySelector(`[data-product="${productData.product}"]`);
  if (originalTile) {
    originalTile.classList.add('selected');
    const checkbox = originalTile.querySelector('input[type="checkbox"]');
    if (checkbox) {
      checkbox.checked = true;
    }
  }

  // Check if product is already in store
  const existingItem = document.querySelector(`.canvas-store-item[data-product="${productData.product}"]`);
  if (existingItem) {
    return; // Already in store
  }

  // Hide placeholder if this is the first item
  const placeholder = document.querySelector('.canvas-placeholder');
  if (placeholder) {
    placeholder.style.display = 'none';
  }

  // Create store item
  const storeItem = document.createElement('div');
  storeItem.className = 'canvas-store-item';
  storeItem.setAttribute('data-product', productData.product);
  storeItem.setAttribute('data-category', productData.category);
  storeItem.setAttribute('data-image', productData.image);
  storeItem.innerHTML = `
    <img src="${productData.image}" alt="${productData.product}">
    <div class="canvas-store-item-content">
      <h4>${productData.product}</h4>
      <p class="canvas-store-item-category">${productData.category}</p>
      </div>
    <button class="canvas-store-item-remove" onclick="removeProductFromStore('${productData.product}')">
      <i class="fas fa-times"></i>
    </button>
  `;

  // Add to canvas
  const canvas = document.getElementById('store-canvas');
  canvas.appendChild(storeItem);

  // Save updated store data
  saveStoreBuilderData();
}

function removeProductFromStore(productName) {
  // Remove from canvas
  const storeItem = document.querySelector(`.canvas-store-item[data-product="${productName}"]`);
  if (storeItem) {
    storeItem.remove();
  }

  // Unselect the original tile
  const originalTile = document.querySelector(`[data-product="${productName}"]`);
  if (originalTile) {
    originalTile.classList.remove('selected');
    const checkbox = originalTile.querySelector('input[type="checkbox"]');
    if (checkbox) {
      checkbox.checked = false;
    }
  }

  // Show placeholder if no items left
  const canvas = document.getElementById('store-canvas');
  const items = canvas.querySelectorAll('.canvas-store-item');
  if (items.length === 0) {
    const placeholder = document.querySelector('.canvas-placeholder');
    if (placeholder) {
      placeholder.style.display = 'block';
    }
  }

  // Save updated store data
  saveStoreBuilderData();
}

function initializeDragAndDrop() {
  // Remove existing event listeners to prevent duplicates
  const productTiles = document.querySelectorAll('.product-tile[draggable="true"]');
  productTiles.forEach(tile => {
    tile.removeEventListener('dragstart', handleDragStart);
    tile.removeEventListener('dragend', handleDragEnd);
    tile.removeEventListener('click', handleTileClick);
  });

  const canvas = document.getElementById('store-canvas');
  if (canvas) {
    canvas.removeEventListener('dragover', handleDragOver);
    canvas.removeEventListener('dragleave', handleDragLeave);
    canvas.removeEventListener('drop', handleDrop);
  }

  // Make product tiles draggable
  productTiles.forEach(tile => {
    tile.addEventListener('dragstart', handleDragStart);
    tile.addEventListener('dragend', handleDragEnd);

    // Handle clicks on the tile (not the checkmark)
    tile.addEventListener('click', handleTileClick);
  });

  // Handle clicks on checkmarks by checking position
  document.addEventListener('click', handleCheckmarkClick);

  // Set up drop zone
  if (canvas) {
    canvas.addEventListener('dragover', handleDragOver);
    canvas.addEventListener('dragleave', handleDragLeave);
    canvas.addEventListener('drop', handleDrop);
  }
}

function handleTileClick(e) {
  // Prevent event if clicking on checkmark
  if (e.target === this.querySelector('::after') || e.target.closest('::after')) {
    return;
  }

  // Ensure we have valid data attributes
  if (!this.dataset.product || !this.dataset.category) {
    console.error('Product tile missing required data attributes:', this);
    return;
  }

  const productData = {
    product: this.dataset.product,
    category: this.dataset.category,
    image: this.dataset.image
  };

  if (this.classList.contains('selected')) {
    // Remove from store
    removeProductFromStore(productData.product);
  } else {
    // Add to store
    addProductToStore(productData);
  }
}

function handleCheckmarkClick(e) {
  const target = e.target;
  if (target.classList.contains('product-tile') && target.classList.contains('selected')) {
    const rect = target.getBoundingClientRect();
    const clickX = e.clientX - rect.left;
    const clickY = e.clientY - rect.top;

    // Check if click is within checkmark area (top-right corner)
    if (clickX >= rect.width - 32 && clickY <= 32) {
      // Ensure we have valid data attributes
      if (!target.dataset.product) {
        console.error('Product tile missing product data attribute for checkmark removal:', target);
        return;
      }

      const productData = {
        product: target.dataset.product,
        category: target.dataset.category,
        image: target.dataset.image
      };
      removeProductFromStore(productData.product);
      e.stopPropagation();
      return;
    }
  }
}

function saveCompanyStorePlan() {
  // Check if any products are selected
  const selectedProducts = document.querySelectorAll('.product-tile input[name="planList"]:checked');

  if (selectedProducts.length === 0) {
    alert("Please add at least one product to your company store before saving your plan.");
    return;
  }

  // Scroll to and reveal the contact section
  const contactSection = document.getElementById('contact-delivery-section');
  if (contactSection) {
    // Remove the display: none style to reveal the section
    contactSection.style.display = 'block';

    // Smooth scroll to the contact section with proper offset
    setTimeout(() => {
      contactSection.scrollIntoView({
        behavior: 'smooth',
        block: 'start',
        inline: 'nearest'
      });

      // Add highlight effect
      contactSection.style.transition = 'all 0.3s ease';
      contactSection.style.boxShadow = '0 0 20px rgba(58, 12, 163, 0.3)';
      setTimeout(() => {
        contactSection.style.boxShadow = '';
      }, 2000);
    }, 100); // Small delay to ensure section is rendered
  }
}

function populatePlanSummary(data) {
  // Populate products list
  const productsList = document.getElementById('summary-modules-list');
  if (productsList) {
    let html = '';

    // Add selected products
    if (data.products && data.products.length > 0) {
      html += data.products.map(product => `<li>${product.value}</li>`).join('');
    }

    // Add custom ideas
    if (data.customIdeas && data.customIdeas.length > 0) {
      data.customIdeas.forEach(idea => {
        html += `<li><strong>Custom Idea:</strong> ${idea}</li>`;
      });
    }

    productsList.innerHTML = html;
  }

  // Populate contact info
  const contactInfo = document.getElementById('summary-contact-info');
  if (contactInfo) {
    const contactDetails = [];
    if (data.firstName || data.lastName) {
      contactDetails.push(`<strong>Name:</strong> ${data.firstName} ${data.lastName}`);
    }
    if (data.companyName) {
      contactDetails.push(`<strong>Company:</strong> ${data.companyName}`);
    }
    if (data.email) {
      contactDetails.push(`<strong>Email:</strong> ${data.email}`);
    }
    if (data.phone) {
      contactDetails.push(`<strong>Phone:</strong> ${data.phone}`);
    }
    contactInfo.innerHTML = contactDetails.join('<br>');
  }
}

function revealPlanSummary() {
  const planSummarySection = document.getElementById('plan-summary-section');
  if (planSummarySection) {
    // Reveal the section
    planSummarySection.style.display = 'block';

    // Smooth scroll to the plan summary with proper offset
    setTimeout(() => {
      planSummarySection.scrollIntoView({
        behavior: 'smooth',
        block: 'start',
        inline: 'nearest'
      });

      // Add highlight effect
      planSummarySection.style.transition = 'all 0.3s ease';
      planSummarySection.style.boxShadow = '0 0 20px rgba(58, 12, 163, 0.3)';
      setTimeout(() => {
        planSummarySection.style.boxShadow = '';
      }, 2000);
    }, 100); // Small delay to ensure section is rendered
  }
}

// Custom Product Ideas Management
let customIdeas = [];

// Store Builder Persistence Management
const STORE_STORAGE_KEY = 'companyStoreBuilderData';

function initializeCustomIdeas() {
  const textarea = document.getElementById('custom-product-input');
  const addButton = document.getElementById('add-custom-idea-btn');

  if (textarea && addButton) {
    // Enable/disable button based on textarea content
    textarea.addEventListener('input', function() {
      addButton.disabled = this.value.trim().length === 0;
    });

    // Handle Enter key to add idea
    textarea.addEventListener('keydown', function(e) {
      if (e.key === 'Enter' && !e.shiftKey && this.value.trim().length > 0) {
        e.preventDefault();
        addCustomIdea();
      }
    });

    // Handle add button click
    addButton.addEventListener('click', addCustomIdea);
  }
}

function addCustomIdea() {
  const textarea = document.getElementById('custom-product-input');
  const ideaText = textarea.value.trim();

  if (!ideaText) return;

  // Add to custom ideas array
  customIdeas.push(ideaText);

  // Create custom product data for store canvas
  const customProductData = {
    product: ideaText,
    category: "Custom Product Idea",
    image: "assets/images/CustomizedTokens.png" // Using an appropriate default image
  };

  // Add to store canvas
  addCustomIdeaToStore(customProductData);

  // Clear textarea
  textarea.value = '';

  // Update UI
  updateCustomIdeasList();

  // Disable button since textarea is now empty
  document.getElementById('add-custom-idea-btn').disabled = true;
}

function addCustomIdeaToStore(productData) {
  // Check if product is already in store
  const existingItem = document.querySelector(`.canvas-store-item[data-product="${productData.product}"]`);
  if (existingItem) {
    return; // Already in store
  }

  // Hide placeholder if this is the first item
  const placeholder = document.querySelector('.canvas-placeholder');
  if (placeholder) {
    placeholder.style.display = 'none';
  }

  // Create store item
  const storeItem = document.createElement('div');
  storeItem.className = 'canvas-store-item custom-idea-item';
  storeItem.setAttribute('data-product', productData.product);
  storeItem.setAttribute('data-category', 'custom-idea');
  storeItem.setAttribute('data-image', productData.image);
  storeItem.innerHTML = `
    <img src="${productData.image}" alt="${productData.product}">
    <div class="canvas-store-item-content">
      <h4>${productData.product}</h4>
      <p class="canvas-store-item-category">${productData.category}</p>
        </div>
    <button class="canvas-store-item-remove" onclick="removeCustomIdeaFromStore('${productData.product}')">
      <i class="fas fa-times"></i>
    </button>
  `;

  // Add to canvas
  const canvas = document.getElementById('store-canvas');
  canvas.appendChild(storeItem);

  // Save updated store data
  saveStoreBuilderData();
}

function removeCustomIdea(index) {
  // Get the idea text before removing it
  const ideaText = customIdeas[index];

  // Remove from custom ideas array
  customIdeas.splice(index, 1);

  // Remove from store canvas
  removeCustomIdeaFromStore(ideaText);

  // Update UI
  updateCustomIdeasList();
}

function removeCustomIdeaFromStore(productName) {
  // Remove from canvas
  const storeItem = document.querySelector(`.canvas-store-item[data-product="${productName}"]`);
  if (storeItem) {
    storeItem.remove();
  }

  // Remove from custom ideas array (find by text match)
  const index = customIdeas.findIndex(idea => idea === productName);
  if (index !== -1) {
    customIdeas.splice(index, 1);
    updateCustomIdeasList();
  }

  // Show placeholder if no items left
  const canvas = document.getElementById('store-canvas');
  const items = canvas.querySelectorAll('.canvas-store-item');
  if (items.length === 0) {
    const placeholder = document.querySelector('.canvas-placeholder');
    if (placeholder) {
      placeholder.style.display = 'block';
    }
  }

  // Save updated store data
  saveStoreBuilderData();
}

function updateCustomIdeasList() {
  const listContainer = document.getElementById('custom-ideas-list');

  if (customIdeas.length === 0) {
    listContainer.innerHTML = '';
    return;
  }

  listContainer.innerHTML = customIdeas.map((idea, index) => `
    <div class="custom-idea-item">
      <p class="custom-idea-text">${idea}</p>
      <button class="custom-idea-remove" onclick="removeCustomIdea(${index})" title="Remove this idea">
        <i class="fas fa-times"></i>
      </button>
          </div>
  `).join('');
}

function clearStore() {
  // Clear all store items
  const storeItems = document.querySelectorAll('.canvas-store-item');
  storeItems.forEach(item => {
    const productName = item.dataset.product;
    const category = item.dataset.category;

    if (category === 'custom-idea') {
      // Remove custom idea
      removeCustomIdeaFromStore(productName);
    } else {
      // Remove regular product
      removeProductFromStore(productName);
    }
  });

  // Reset form
  const form = document.getElementById("plan-details-form");
  if (form) {
    form.reset();
  }

  // Clear custom ideas array (in case some weren't removed above)
  customIdeas = [];
  updateCustomIdeasList();

  // Clear the textarea
  const customTextarea = document.getElementById('custom-product-input');
  if (customTextarea) {
    customTextarea.value = '';
    document.getElementById('add-custom-idea-btn').disabled = true;
  }

  // Clear stored data
  localStorage.removeItem(STORE_STORAGE_KEY);
}

// Save Store Builder Data
function saveStoreBuilderData() {
  const storeData = {
    regularProducts: [],
    customIdeas: [...customIdeas],
    timestamp: new Date().toISOString()
  };

  // Get all regular products in the store canvas
  const storeItems = document.querySelectorAll('.canvas-store-item');
  storeItems.forEach(item => {
    const category = item.dataset.category;
    if (category !== 'custom-idea') {
      storeData.regularProducts.push({
        product: item.dataset.product,
        category: category,
        image: item.dataset.image
      });
    }
  });

  // Save to localStorage
  try {
    localStorage.setItem(STORE_STORAGE_KEY, JSON.stringify(storeData));
  } catch (error) {
    console.warn('Failed to save store builder data:', error);
  }
}

// Load Store Builder Data
function loadStoreBuilderData() {
  try {
    const storedData = localStorage.getItem(STORE_STORAGE_KEY);
    if (!storedData) return;

    const storeData = JSON.parse(storedData);

    // Load regular products
    if (storeData.regularProducts && storeData.regularProducts.length > 0) {
      storeData.regularProducts.forEach(productData => {
        // Find the original tile and mark it as selected
        const originalTile = document.querySelector(`[data-product="${productData.product}"]`);
        if (originalTile) {
          originalTile.classList.add('selected');
          const checkbox = originalTile.querySelector('input[type="checkbox"]');
          if (checkbox) {
            checkbox.checked = true;
          }
        }

        // Add to store canvas
        addProductToStore(productData);
      });
    }

    // Load custom ideas
    if (storeData.customIdeas && storeData.customIdeas.length > 0) {
      storeData.customIdeas.forEach(ideaText => {
        // Add to custom ideas array
        customIdeas.push(ideaText);

        // Create custom product data for store canvas
        const customProductData = {
          product: ideaText,
          category: "Custom Product Idea",
          image: "assets/images/CustomizedTokens.png"
        };

        // Add to store canvas
        addCustomIdeaToStore(customProductData);
      });

      // Update the custom ideas list UI
      updateCustomIdeasList();
    }

  } catch (error) {
    console.warn('Failed to load store builder data:', error);
    // Clear corrupted data
    localStorage.removeItem(STORE_STORAGE_KEY);
  }
}

// Advanced Captcha System
const captchaTypes = {
  math: {
    name: 'Math Equation',
    generate: function() {
      const operations = ['+', '-', '*'];
      const num1 = Math.floor(Math.random() * 20) + 1;
      const num2 = Math.floor(Math.random() * 20) + 1;
      const operation = operations[Math.floor(Math.random() * operations.length)];

      let question, answer;

      switch(operation) {
        case '+':
          question = `${num1} + ${num2}`;
          answer = num1 + num2;
          break;
        case '-':
          // Ensure positive result
          const larger = Math.max(num1, num2);
          const smaller = Math.min(num1, num2);
          question = `${larger} - ${smaller}`;
          answer = larger - smaller;
          break;
        case '*':
          // Keep multiplication simple for usability
          const simple1 = Math.floor(Math.random() * 10) + 1;
          const simple2 = Math.floor(Math.random() * 10) + 1;
          question = `${simple1} Ã— ${simple2}`;
          answer = simple1 * simple2;
          break;
      }

      return { question, answer };
    }
  },

  wordProblem: {
    name: 'Word Problem',
    generate: function() {
      const scenarios = [
        {
          template: 'A farmer has {num1} apples and gives {num2} to his neighbor. How many apples does he have left?',
          calculate: (a, b) => Math.max(a, b) - Math.min(a, b)
        },
        {
          template: 'Sarah bought {num1} books at ${num2} each. How much did she spend?',
          calculate: (a, b) => a * b
        },
        {
          template: 'There are {num1} students in a class. {num2} more join. How many students are there now?',
          calculate: (a, b) => a + b
        },
        {
          template: 'A rectangle has length {num1} and width {num2}. What is its area?',
          calculate: (a, b) => a * b
        }
      ];

      const scenario = scenarios[Math.floor(Math.random() * scenarios.length)];
      const num1 = Math.floor(Math.random() * 15) + 1;
      const num2 = Math.floor(Math.random() * 15) + 1;

      const question = scenario.template
        .replace('{num1}', num1)
        .replace('{num2}', num2);
      const answer = scenario.calculate(num1, num2);

      return { question, answer };
    }
  },

  shapeLogic: {
    name: 'Shape Logic',
    generate: function() {
      const shapes = ['circle', 'square', 'triangle', 'diamond'];
      const colors = ['red', 'blue', 'green', 'yellow'];

      const shape1 = shapes[Math.floor(Math.random() * shapes.length)];
      const shape2 = shapes[Math.floor(Math.random() * shapes.length)];
      const color1 = colors[Math.floor(Math.random() * colors.length)];
      const color2 = colors[Math.floor(Math.random() * colors.length)];

      // Simple logic: count how many unique items
      const uniqueItems = new Set([shape1, shape2, color1, color2]).size;

      const question = `Count the unique items: ${color1} ${shape1}, ${color2} ${shape2}, ${color1} ${shape1}, ${color2} ${shape2}`;
      const answer = uniqueItems;

      return { question, answer };
    }
  },

  patternSequence: {
    name: 'Pattern Sequence',
    generate: function() {
      const patterns = [
        {
          sequence: [2, 4, 6, 8],
          next: 10,
          description: 'What number comes next: 2, 4, 6, 8, ?'
        },
        {
          sequence: [1, 4, 9, 16],
          next: 25,
          description: 'What number comes next: 1, 4, 9, 16, ?'
        },
        {
          sequence: [3, 6, 9, 12],
          next: 15,
          description: 'What number comes next: 3, 6, 9, 12, ?'
        },
        {
          sequence: [5, 10, 15, 20],
          next: 25,
          description: 'What number comes next: 5, 10, 15, 20, ?'
        }
      ];

      const pattern = patterns[Math.floor(Math.random() * patterns.length)];
      return {
        question: pattern.description,
        answer: pattern.next
      };
    }
  },

  visualPattern: {
    name: 'Visual Pattern',
    generate: function() {
      const patterns = [
        {
          description: 'Complete the pattern: â–² â–¼ â–² â–¼ â–² ?',
          answer: 'â–¼'
        },
        {
          description: 'Complete the pattern: ðŸ”µ ðŸ”´ ðŸ”µ ðŸ”´ ðŸ”µ ?',
          answer: 'ðŸ”´'
        },
        {
          description: 'Complete the pattern: 1 2 3 1 2 ?',
          answer: '3'
        },
        {
          description: 'Complete the pattern: A B C A B ?',
          answer: 'C'
        }
      ];

      return patterns[Math.floor(Math.random() * patterns.length)];
    }
  },

  timeCalculation: {
    name: 'Time Calculation',
    generate: function() {
      const times = [
        { start: '2:30', add: 45, result: '3:15' },
        { start: '1:45', add: 30, result: '2:15' },
        { start: '3:20', add: 40, result: '4:00' },
        { start: '4:50', add: 25, result: '5:15' }
      ];

      const timeCalc = times[Math.floor(Math.random() * times.length)];
      return {
        question: `If it's ${timeCalc.start} and you add ${timeCalc.add} minutes, what time is it? (Format: H:MM)`,
        answer: timeCalc.result
      };
    }
  }
};

let currentCaptcha = null;
let currentCaptchaType = 'math';

function initializeCaptcha() {
  generateCaptcha();
}

function generateCaptcha(type = currentCaptchaType) {
  currentCaptchaType = type;
  const captchaType = captchaTypes[type];

  if (!captchaType) {
    console.error('Invalid captcha type:', type);
    return;
  }

  currentCaptcha = captchaType.generate();

  // Update the UI
  document.getElementById('captcha-question').textContent = currentCaptcha.question;

  // Store the answer for validation
  document.getElementById('captcha-num1').value = currentCaptcha.answer;

  // Clear the input field
  document.getElementById('captcha').value = '';
}

function validateCaptcha() {
  const userAnswer = document.getElementById('captcha').value.trim();
  const correctAnswer = currentCaptcha ? currentCaptcha.answer.toString() : '';

  return userAnswer === correctAnswer;
}

function createCaptchaSelector() {
  const selectorHTML = `
    <div class="captcha-selector" style="margin-bottom: 15px;">
      <label style="display: block; margin-bottom: 8px; font-weight: 600;">Security Challenge Type:</label>
      <select id="captcha-type-selector" style="padding: 8px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px;">
        <option value="math">Math Equation (Easy)</option>
        <option value="wordProblem">Word Problem (Medium)</option>
        <option value="patternSequence">Pattern Sequence (Medium)</option>
        <option value="timeCalculation">Time Calculation (Hard)</option>
        <option value="shapeLogic">Shape Logic (Hard)</option>
        <option value="visualPattern">Visual Pattern (Expert)</option>
      </select>
      <button type="button" id="new-captcha-btn" style="margin-left: 10px; padding: 8px 12px; background: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer;">New Challenge</button>
    </div>
  `;

  // Insert before the captcha input
  const captchaLabel = document.querySelector('label[for="captcha"]');
  if (captchaLabel) {
    captchaLabel.insertAdjacentHTML('beforebegin', selectorHTML);

    // Add event listeners
    document.getElementById('captcha-type-selector').addEventListener('change', function() {
      generateCaptcha(this.value);
    });

    document.getElementById('new-captcha-btn').addEventListener('click', function() {
      generateCaptcha();
    });
  }
}

document.addEventListener("DOMContentLoaded", function () {
  // Initialize drag and drop functionality
  initializeDragAndDrop();

  // Initialize custom ideas functionality
  initializeCustomIdeas();

  // Load previously saved store builder data
  loadStoreBuilderData();

  // Initialize captcha system
  initializeCaptcha();

  // Create captcha selector
  setTimeout(createCaptchaSelector, 100);

  // Also initialize after any category expansion
  window.reinitializeCompanyStoreDragAndDrop = function() {
    initializeDragAndDrop();
  };

      const form = document.getElementById("plan-details-form");
      form.addEventListener("submit", function(event) {
        event.preventDefault();

    // Validate captcha first
    if (!validateCaptcha()) {
      alert("Security check failed. Please solve the challenge correctly.");
      // Generate a new captcha
      generateCaptcha();
      return;
    }

    // Get selected products from the new interface
    selectedProducts = Array.from(document.querySelectorAll('.product-tile input[name="planList"]:checked'));
    formattedPlans = `<ul>${selectedProducts.map(input => `<li>${input.value}</li>`).join('')}</ul>`;

    // Get custom product ideas
    const customIdeasFormatted = customIdeas.length > 0
      ? `<br><strong>Custom Product Ideas:</strong><ul>${customIdeas.map(idea => `<li>${idea}</li>`).join('')}</ul>`
      : '';

    // Combine all product information
    const allProducts = formattedPlans + customIdeasFormatted;
        affiliateName = document.getElementsByName('affiliateName')[0]?.value || '';
        affiliateEmail = document.getElementsByName('affiliateEmail')[0]?.value || '';
        headerImgPath = document.getElementsByName('headerImgPath')[0]?.value || '';
        footerImgPath = document.getElementsByName('footerImgPath')[0]?.value || '';
        firstName = document.getElementsByName('firstName')[0]?.value || '';
        lastName = document.getElementsByName('lastName')[0]?.value || '';
        phone = document.getElementsByName('phone')[0]?.value || '';
        email = document.getElementsByName('email')[0]?.value || '';
        companyName = document.getElementsByName('companyName')[0]?.value || '';

        emailjs.send("service_ag1505e", "template_1cfzg9f", {
      planList: allProducts,
          affiliateName: affiliateName,
          affiliateEmail: affiliateEmail,
          headerImgPath: headerImgPath,
          footerImgPath: footerImgPath,
          firstName: firstName,
          lastName: lastName,
          phone: phone,
          email: email,
          companyName: companyName,
        })
          .then(() => {
            alert("Your submission was successful!");

        // Populate and reveal the plan summary
        populatePlanSummary({
          products: selectedProducts,
          customIdeas: customIdeas,
          firstName: firstName,
          lastName: lastName,
          companyName: companyName,
          email: email,
          phone: phone
        });

        // Reveal and scroll to plan summary
        revealPlanSummary();

        // Reset the form
            form.reset();

        // Generate new captcha after successful submission
        setTimeout(() => generateCaptcha(), 1000);
          }, (error) => {
            alert("Your submission failed to save: " + JSON.stringify(error));
          });
      });
});
</script>
<script src="footer.js" defer></script>
</body>
